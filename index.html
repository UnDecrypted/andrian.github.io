<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>UnDecrypted.co</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
        <style>
            body {
                overflow-x: hidden;
            }
            .translate-button {
                position: fixed;
                bottom: 20px;
                right: 20px;
                z-index: 1000;
            }
            .translate-box {
                position: fixed;
                bottom: 80px;
                right: 20px;
                width: 250px;
                display: none;
            }
            #carouselExampleCaptions {
                max-width: 800px; /* Adjust the width as needed */
                margin: auto;
            }
            .carousel-inner img {
                max-height: 400px; /* Adjust the height as needed */
                object-fit: cover;
            }
        </style>
    </head>
    <body>
        <nav class="navbar navbar-expand-lg bg-body-tertiary shadow border-bottom border-black w-100" style="top: 0; position: sticky; z-index: 100;">
            <div class="container-fluid">
                <a class="navbar-brand fw-bold" href="index">𝔘𝔫𝔇𝔢𝔠𝔯𝔶𝔭𝔱𝔢𝔡.𝔠𝔬</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="testimonial">Testimonial</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="about">About</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1" aria-label="Slide 2"></button>
                <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2" aria-label="Slide 3"></button>
                <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="3" aria-label="Slide 4"></button>
            </div>
            <div class="carousel-inner" id="carouselContainer">
                <!-- Slides will be inserted here dynamically -->
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>

        <div class="navbar navbar-expand-lg bg-body-tertiary shadow border-bottom border-black">
            <div class="container-fluid">
                <div class="input-group w-100 col-lg-6 col-md-8 mx-auto">
                    <span class="input-group-text bg-dark text-white bi-search" id="basic-addon1"></span>
                    <input id="search-input" type="text" class="form-control border-dark" placeholder="Search for items..." aria-label="Items" aria-describedby="basic-addon1">
                    
                    <!-- Sorting Dropdown (smaller) -->
                    <select class="form-select form-select border-dark ms-2" id="sorting-dropdown" aria-label="Sort items">
                        <option selected disabled>Sort By</option>
                        <option value="price-low-high">Price: Low to High</option>
                        <option value="price-high-low">Price: High to Low</option>
                    </select>
                </div>      
            </div>
        </div>        

        <div id="products" class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-3 p-3">
            <script>
                const webhookUrl = 'https://discord.com/api/webhooks/1357192449604190228/KeoSVe1-cwaE_4nJr_B8C-M3FFMKPWgAaWmSILpBZPB8XKT5UtZ03172VUCcqFHEsa2Z'; // Replace with your actual Discord webhook URL
            
                // Function to fetch user's IP address
                function getUserIP() {
                    return fetch('https://api.ipify.org?format=json')
                        .then(response => response.json())
                        .then(data => data.ip)
                        .catch(() => 'Unable to retrieve IP');
                }
            
                // Function to get browser and device type information
                function getBrowserAndDeviceInfo() {
                    const userAgent = navigator.userAgent;
                    const isMobile = /mobile/i.test(userAgent);
                    const browserInfo = userAgent;
            
                    const deviceType = isMobile ? 'Mobile Device' : 'Desktop Device';
                    return {
                        browser: browserInfo,
                        deviceType: deviceType,
                    };
                }
            
                // Prepare the embed message
                async function prepareMessage() {
                    const ipAddress = await getUserIP();
                    const { browser, deviceType } = getBrowserAndDeviceInfo();
            
                    const message = {
                        content: '',
                        embeds: [
                            {
                                title: document.title, // Set the title to the current page title
                                description: '',
                                url: window.location.href, // Dynamic URL of the current page
                                color: 3447003, // Optional: embed color (decimal hex)
                                author: {
                                    name: '𝔘𝔫𝔇𝔢𝔠𝔯𝔶𝔭𝔱𝔢𝔡.𝔠𝔬', // Optional: author of the embed
                                    url: 'https://undecrypted.github.io/', // Optional: URL to link author to
                                    icon_url: 'https://avatars.githubusercontent.com/u/155349824?v=4&size=64', // Optional: author icon URL
                                },
                                thumbnail: {
                                    url: '', // Optional: image to appear as a thumbnail
                                },
                                image: {
                                    url: '', // Optional: large image to display
                                },
                                fields: [
                                    {
                                        name: 'IP Address', // Field name
                                        value: ipAddress || 'Not available', // Field value (IP Address)
                                        inline: false,
                                    },
                                    {
                                        name: 'Browser Information', // Field name
                                        value: browser || 'Not available', // Field value (Browser Info)
                                        inline: false,
                                    },
                                    {
                                        name: 'Device Type', // Field name
                                        value: deviceType || 'Not available', // Field value (Device Type)
                                        inline: false,
                                    },
                                ],
                                footer: {
                                    text: 'Powered by UnDecrypted', // Footer text
                                    icon_url: 'https://example.com/footer-icon.png', // Optional: footer icon
                                },
                                timestamp: new Date(), // Optional: timestamp for the embed
                            },
                        ],
                    };
            
                    return message;
                }
            
                // Function to send the message to Discord webhook
                async function sendToDiscord() {
                    const message = await prepareMessage(); // Wait for the message to be prepared
            
                    fetch(webhookUrl, {
                        method: 'POST', // POST request to send the message
                        headers: {
                            'Content-Type': 'application/json', // Sending data as JSON
                        },
                        body: JSON.stringify(message), // Convert the message object to a JSON string
                    })
                    .then(response => {
                        if (response.ok) {
                            console.log('Message sent successfully!');
                        } else {
                            console.error('Error sending message:', response.statusText);
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error); // Log any errors that occur
                    });
                }
            
                // Send the message
                sendToDiscord(); // Now it will work properly
            </script>

            <script>
                function generateWa(txt) {
                    var wa = "https://api.whatsapp.com/send?phone=6288217875066&text=" + encodeURIComponent(txt);
                    return wa;
                }

                console.log(generateWa("Hello, I am interested in your product."));

                fetch('static/carousel.json') // Make sure you have a JSON file named carousel.json
                    .then(response => response.json())
                    .then(data => {
                        const container = document.getElementById('carouselContainer');
                        data.forEach((item, index) => {
                            const slide = document.createElement('div');
                            slide.className = `carousel-item ${index === 0 ? 'active' : ''}`;
                            slide.innerHTML = `
                                <img src="${item.image}" class="d-block w-100" alt="${item.alt}">
                                <div class="carousel-caption d-none d-md-block">
                                    <h5>${item.title}</h5>
                                    <p>${item.description}</p>
                                </div>
                            `;
                            container.appendChild(slide);
                        });
                    })
                    .catch(error => console.error('Error loading JSON:', error));

                fetch("static/products.json")
                    .then(response => response.json())
                    .then(data => {
                        let products = data;  // Store original products data

                        // Render products function
                        function renderProducts(productsToRender) {
                            const productsContainer = document.getElementById("products");
                            productsContainer.innerHTML = ""; // Clear previous content

                            productsToRender.forEach(item => {
                                const storageKey = `buyCooldown_${item.name}`;

                                const productCard = document.createElement("div");
                                productCard.className = "col";
                                productCard.innerHTML = `
                                    <div class="card m-3 shadow">
                                        <img src="${item.image}" class="card-img-top" alt="${item.name}">
                                        <div class="card-body">
                                            <h5 class="card-title m-0">Rp ${item.price}</h5>
                                            <h6 class="card-text m-0" style="opacity:0.75;">${item.name}</h6>
                                            <p class="card-text text-truncate" style="opacity:0.75;">${item.description}</p>
                                            <a href="view?name=${item.name}" class="btn btn-outline-dark me-2">View</a>
                                            <button class="btn btn-outline-dark me-2 buy-now" 
                                                    data-url="${generateWa(`Hello, Apakah Barang \n \n ${item.name} \n \n Masih Ada?`)}"
                                                    data-key="${storageKey}">
                                                Buy Now
                                            </button>
                                        </div>
                                    </div>
                                `;

                                productsContainer.appendChild(productCard);
                            });

                            // Add event listener to all "Buy Now" buttons
                            document.querySelectorAll(".buy-now").forEach(button => {
                                const storageKey = button.getAttribute("data-key");

                                // Check cooldown on page load
                                checkCooldown(button, storageKey);

                                button.addEventListener("click", function () {
                                    const url = this.getAttribute("data-url");

                                    // Check if cooldown is still active
                                    if (isCooldownActive(storageKey)) {
                                        alert("Please wait before buying again!");
                                        return;
                                    }

                                    // Set cooldown
                                    setCooldown(storageKey, 5000); // 5 seconds

                                    // Disable button
                                    this.disabled = true;

                                    // Open WhatsApp link
                                    window.open(url, "_blank");

                                    // Re-enable button after cooldown
                                    setTimeout(() => {
                                        this.disabled = false;
                                    }, 5000);
                                });
                            });
                        }

                        // Initial render
                        renderProducts(products);

                        // Sorting function
                        document.getElementById('sorting-dropdown').addEventListener('change', function () {
                            const selectedOption = this.value;
                            let sortedProducts = [...products]; // Make a copy of the products array

                            // Sort based on selected option
                            if (selectedOption === 'price-low-high') {
                                sortedProducts.sort((a, b) => {
                                    // Convert the price string to a number by removing periods
                                    let priceA = parseFloat(a.price.replace(/\./g, ''));
                                    let priceB = parseFloat(b.price.replace(/\./g, ''));
                                    
                                    return priceA - priceB;  // Sort from low to high
                                });
                            } else if (selectedOption === 'price-high-low') {
                                sortedProducts.sort((a, b) => {
                                    // Convert the price string to a number by removing periods
                                    let priceA = parseFloat(a.price.replace(/\./g, ''));
                                    let priceB = parseFloat(b.price.replace(/\./g, ''));
                                    
                                    return priceB - priceA;  // Sort from high to low
                                });
                            }

                            // Render sorted products
                            renderProducts(sortedProducts);
                        });
                    })
                    .catch(error => console.error("Error loading JSON:", error));

                // Function to generate WhatsApp link
                function generateWa(txt) {
                    var wa = "https://api.whatsapp.com/send?phone=6288217875066&text=" + encodeURIComponent(txt);
                    return wa;
                }

                // Function to check if cooldown is active
                function isCooldownActive(storageKey) {
                    const lastClick = localStorage.getItem(storageKey);
                    if (!lastClick) return false;

                    const timePassed = Date.now() - parseInt(lastClick, 10);
                    return timePassed < 5000; // Cooldown period (5 seconds)
                }

                // Function to set cooldown in LocalStorage
                function setCooldown(storageKey, cooldownTime) {
                    localStorage.setItem(storageKey, Date.now());
                }

                // Function to check cooldown on page load
                function checkCooldown(button, storageKey) {
                    if (isCooldownActive(storageKey)) {
                        button.disabled = true;
                        const remainingTime = 5000 - (Date.now() - parseInt(localStorage.getItem(storageKey), 10));
                        setTimeout(() => {
                            button.disabled = false;
                        }, remainingTime);
                    }
                }
            </script>
            <!-- <div class="col">
                <div id="p-card" class="card m-3 shadow">
                    <img src="static/images/p.jpg" class="card-img-top" alt="...">
                    <div class="card-body">
                        <h5 id="card-tit" class="card-title m-0">Rp 20.000</h5>
                        <h6 class="card-text m-0" style="opacity:0.75;">Sisri Apel</h6>
                        <p class="card-text text-truncate" style="opacity:0.75;">Seger Boloo</p>
                        <a href="#" class="btn btn-outline-dark me-2">Go somewhere</a>
                    </div>
                </div>
            </div> -->
        </div>
        
        <button class="btn btn-primary translate-button" onclick="toggleTranslate()">
            🌍 Translate
        </button>
    
        <!-- Google Translate Widget Box -->
        <div id="translateBox" class="translate-box card shadow p-3">
            <h6 class="text-center">Select Language</h6>
            <div class="btn btn-outline-dark" id="google_translate_element"></div>
        </div>
    
        <!-- Google Translate Script -->
        <script>
            function googleTranslateElementInit() {
                new google.translate.TranslateElement({
                    pageLanguage: 'en',
                    includedLanguages: 'id,es,fr,de,ja',
                    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
                }, 'google_translate_element');
            }
    
            function toggleTranslate() {
                let translateBox = document.getElementById("translateBox");
                translateBox.style.display = (translateBox.style.display === "none" || translateBox.style.display === "") ? "block" : "none";
            }
        </script>
    
        <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

        <footer class="text-center py-3">
            <p class="mb-0">© 2025 UnDecrypted.co. All Rights Reserved.</p>
        </footer>
        
        <nav>
            <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
        </nav>

        <script>
            document.getElementById("search-input").addEventListener("input", function(){
                var input = document.getElementById("search-input");
                var divp = document.getElementById("products");
                var cards = divp.getElementsByClassName("col");
                var filter = input.value.toUpperCase();
                for (i = 0; i < cards.length; i++) {
                    var txt = cards[i].getElementsByTagName("h6")[0];
                    if (txt.textContent.toUpperCase().indexOf(filter) > -1) {
                        cards[i].style.display = "";
                    } else {
                        cards[i].style.display = "none";
                    }
                }
            });
        </script>

        <script>
            document.addEventListener("DOMContentLoaded", function() {
                const tl = gsap.timeline({ defaults: { ease: "power3.out", duration: 1.2 } });

                // Navbar slides down smoothly
                tl.from("nav.navbar", { y: -50, opacity: 0 });

                // Carousel fades in with slight scale-up
                tl.from("#carouselExampleCaptions", { opacity: 0, scale: 0.97 }, "-=0.8");

                // Search bar slides in smoothly
                tl.from(".input-group", { x: -80, opacity: 0 }, "-=0.8");

                // Product cards staggered fade-in (with a more seamless flow)
                gsap.from(".col", {
                    opacity: 0,
                    y: 20,
                    duration: 1.5,
                    stagger: 0.15, // Smooth delay between each item
                    delay: 1.5, // Start after initial elements
                    ease: "power3.out"
                });
            });
        </script>
    </body>
</html>
